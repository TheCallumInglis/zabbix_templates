<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.0</version>
    <date>2019-12-31T09:50:37Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
        <group>
            <name>Zabbix Proxies (Supported Customers)</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>External Connectivity</template>
            <name>External Connectivity and IP</name>
            <description/>
            <groups>
                <group>
                    <name>Zabbix Proxies (Supported Customers)</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>External Connectivity</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>External IP Address</name>
                    <type>7</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>web.page.regexp[wtfismyip.com,text,80,&quot;[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+&quot;]</key>
                    <delay>30m</delay>
                    <history>90d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>38</inventory_link>
                    <applications>
                        <application>
                            <name>External Connectivity</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
            </items>
            <discovery_rules/>
            <httptests/>
            <macros/>
            <templates/>
            <screens/>
        </template>
        <template>
            <template>RDP Users</template>
            <name>RDP Users</name>
            <description/>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Audit</name>
                </application>
                <application>
                    <name>RDP</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Default RDP Port</name>
                    <type>0</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>net.tcp.listen[3389]</key>
                    <delay>15m</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Checks if port 3389/TCP is listening. This is the default port</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>RDP</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>6</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Custom RDP Port</name>
                    <type>0</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>net.tcp.listen[7279]</key>
                    <delay>15m</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Checks if port 7279 is listening. Do change this if you use a custom RDP port.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>RDP</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>6</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Logged in  users</name>
                    <type>7</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>RDPUsers</key>
                    <delay>15m</delay>
                    <history>2d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>http://serverfault.com/questions/511120/getting-just-the-active-remote-desktop-sessions</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Audit</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Terminal Server Service</name>
                    <type>0</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>service_state[TermService]</key>
                    <delay>5m</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>If TermService is not running, people cannot RDP in.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>RDP</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>RDPUsers.cmd file Checksum</name>
                    <type>0</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>vfs.file.cksum[C:\Zabbix\RDPUsers.cmd]</key>
                    <delay>15m</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>We check the version of this script in the event we update the cmd file. This is a quick way to confirm which nodes are using the wrong build. Assuming of course, that one updates the complimentary trigger too.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Audit</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>RDPUsers.cmd script check</name>
                    <type>0</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>vfs.file.exists[C:\Zabbix\RDPUsers.cmd]</key>
                    <delay>15m</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>If C:\Zabbix\RDPUsers.cmd does not exist, we cannot monitor the logged in users.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Audit</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>zabbix_agentd.win RDP UserParemeter (Program files Install path)</name>
                    <type>0</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>vfs.file.regmatch[C:\Program Files\Zabbix\conf\zabbix_agentd.win,RDPUsers,UTF8,0,10000]</key>
                    <delay>15m</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>If the zabbix_agentd.win does not contain the line UserParameter=RDPUsers,&quot;c:\zabbix\RDPUsers.cmd&quot; then this check will not work.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Audit</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>zabbix_agentd.conf RDP UserParemeter</name>
                    <type>0</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>vfs.file.regmatch[C:\Zabbix\zabbix_agentd.conf,RDPUsers,UTF8,0,10000]</key>
                    <delay>15m</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>If the zabbix_agentd.conf does not contain the line UserParameter=RDPUsers,&quot;c:\zabbix\RDPUsers.cmd&quot; then this check will not work.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Audit</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
            </items>
            <discovery_rules/>
            <httptests/>
            <macros/>
            <templates/>
            <screens/>
        </template>
        <template>
            <template>Spamhaus Blacklisting</template>
            <name>Spamhaus Blacklisting</name>
            <description>Checks syslog messages to see if a client IP is blackisted.&#13;
&#13;
Very rudimentary template but gets the job done.</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Spamhaus</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>SMTP Bounce Messages</name>
                    <type>7</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>log[/var/log/syslog,&quot;Client host (\[.*\] blocked using \w+)&quot;,,,,\1,]</key>
                    <delay>90s</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>2</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Look for bounce messages in the syslog file</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Spamhaus</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
            </items>
            <discovery_rules/>
            <httptests/>
            <macros/>
            <templates/>
            <screens/>
        </template>
        <template>
            <template>Template SNMP OS ESXi</template>
            <name>Template SNMP OS ESXi</name>
            <description/>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Disk partitions</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Interfaces</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>Processors</name>
                </application>
                <application>
                    <name>RAID</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Device uptime</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>SNMPv2-MIB::sysUpTime.0</snmp_oid>
                    <key>sysUpTime</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units>uptime</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>The time since the network management portion of the system was last re-initialized.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>1</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>VMWare Build</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.6876.1.4.0</snmp_oid>
                    <key>VMProdBuild.0</key>
                    <delay>1h</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port>161</port>
                    <description/>
                    <inventory_link>5</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>ESXi Version</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.4.1.6876.1.2.0</snmp_oid>
                    <key>vmwProdVersion.0</key>
                    <delay>1h</delay>
                    <history>90d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port>161</port>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Disk partitions</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.25.2.3.1.4]</snmp_oid>
                    <key>hrStorageAlloc</key>
                    <delay>15m</delay>
                    <status>0</status>
                    <allowed_hosts/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <filter>
                        <evaltype>0</evaltype>
                        <formula/>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>1048576|4194304|8388608|2097152</value>
                                <operator>8</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>1d</lifetime>
                    <description>The rule will discover all dis partitions matching the global regexp &quot;Storage devices for SNMP discovery&quot;.&#13;
&#13;
{$SNMP_COMMUNITY} is a global macro.&#13;
hrStorageFixedDisk</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Allocation units VMFS {#SNMPINDEX}</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.25.2.3.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>hrStorageAllocationUnits[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Disk partitions</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Description of VMFS {#SNMPINDEX}</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.25.2.3.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>hrStorageDescr[{#SNMPINDEX}]</key>
                            <delay>1h</delay>
                            <history>1w</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>1</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port>161</port>
                            <description>A description of the type and instance of the storage described by this entry.</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Disk partitions</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Total size of VMFS {#SNMPINDEX} in blocks</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>hrStorageSizeBlocks[{#SNMPINDEX}]</key>
                            <delay>1h</delay>
                            <history>1w</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>blocks</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port>161</port>
                            <description>The size of the storage represented by this entry, in units of hrStorageAllocationUnits. This object is writable to allow remote configuration of the size of the storage area in those cases where such an operation makes sense and is possible on the underlying system. For example, the amount of main memory allocated to a buffer pool might be modified or the amount of disk space allocated to virtual memory might be modified.</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Disk partitions</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Total size of VMFS {#SNMPINDEX}</name>
                            <type>15</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>hrStorageSize[{#SNMPINDEX}]</key>
                            <delay>1h</delay>
                            <history>1w</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>Bytes</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params>last(&quot;hrStorageSizeBlocks[{#SNMPINDEX}]&quot;) * last(&quot;hrStorageAllocationUnits[{#SNMPINDEX}]&quot;)</params>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>The size of the storage represented by this entry, in units of hrStorageAllocationUnits. This object is writable to allow remote configuration of the size of the storage area in those cases where such an operation makes sense and is possible on the underlying system. For example, the amount of main memory allocated to a buffer pool might be modified or the amount of disk space allocated to virtual memory might be modified.</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Disk partitions</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Used disk on VMFS {#SNMPINDEX} in blocks</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>hrStorageUsedBlocks[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>MB</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port>161</port>
                            <description>The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Disk partitions</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Used disk on VMFS {#SNMPINDEX}</name>
                            <type>15</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>hrStorageUsed[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>Bytes</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params>last(&quot;hrStorageUsedBlocks[{#SNMPINDEX}]&quot;) * last(&quot;hrStorageAllocationUnits[{#SNMPINDEX}]&quot;)</params>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Disk partitions</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Used Space % on VMFS {#SNMPINDEX}</name>
                            <type>15</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>vmfs.FreeSpacePer[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>0</value_type>
                            <allowed_hosts/>
                            <units>%</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params>last(&quot;hrStorageUsed[{#SNMPINDEX}]&quot;)/last(&quot;hrStorageSize[{#SNMPINDEX}]&quot;)*100</params>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Disk partitions</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Free Space on VMFS {#SNMPINDEX}</name>
                            <type>15</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>vmfs.FreeSpace[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>Bytes</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params>last(&quot;hrStorageSize[{#SNMPINDEX}]&quot;)-last(&quot;hrStorageUsed[{#SNMPINDEX}]&quot;)</params>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Disk partitions</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>({Template SNMP OS ESXi:hrStorageUsedBlocks[{#SNMPINDEX}].last(0)} / {Template SNMP OS ESXi:hrStorageSizeBlocks[{#SNMPINDEX}].last(0)} &gt; 0.9) and ({Template SNMP OS ESXi:vmfs.FreeSpace[{#SNMPINDEX}].last(0)} &lt; 20G)</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>Free disk space is less than 10% on volume {#SNMPINDEX}, {ITEM.LASTVALUE3} remaining</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>3</priority>
                            <description/>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags/>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>({Template SNMP OS ESXi:hrStorageUsedBlocks[{#SNMPINDEX}].last(0)} / {Template SNMP OS ESXi:hrStorageSizeBlocks[{#SNMPINDEX}].last(0)} &gt; 0.85) and ({Template SNMP OS ESXi:hrStorageUsedBlocks[{#SNMPINDEX}].last(0)} / {Template SNMP OS ESXi:hrStorageSizeBlocks[{#SNMPINDEX}].last(0)} &lt; 0.9) and ({Template SNMP OS ESXi:vmfs.FreeSpace[{#SNMPINDEX}].last(0)} &lt; 40G)</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>Free disk space is less than 15% on volume {#SNMPINDEX}, {ITEM.LASTVALUE5} remaining</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>2</priority>
                            <description/>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags/>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Storage Use</name>
                            <width>900</width>
                            <height>200</height>
                            <yaxismin>0.0000</yaxismin>
                            <yaxismax>100.0000</yaxismax>
                            <show_work_period>1</show_work_period>
                            <show_triggers>1</show_triggers>
                            <type>1</type>
                            <show_legend>1</show_legend>
                            <show_3d>0</show_3d>
                            <percent_left>0.0000</percent_left>
                            <percent_right>0.0000</percent_right>
                            <ymin_type_1>0</ymin_type_1>
                            <ymax_type_1>0</ymax_type_1>
                            <ymin_item_1>0</ymin_item_1>
                            <ymax_item_1>0</ymax_item_1>
                            <graph_items>
                                <graph_item>
                                    <sortorder>0</sortorder>
                                    <drawtype>0</drawtype>
                                    <color>C80000</color>
                                    <yaxisside>0</yaxisside>
                                    <calc_fnc>2</calc_fnc>
                                    <type>0</type>
                                    <item>
                                        <host>Template SNMP OS ESXi</host>
                                        <key>vmfs.FreeSpacePer[{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <host_prototypes/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                </discovery_rule>
                <discovery_rule>
                    <name>Memory</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.25.2.3.1.3]</snmp_oid>
                    <key>hrStorageDescr</key>
                    <delay>10m</delay>
                    <status>0</status>
                    <allowed_hosts/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <filter>
                        <evaltype>0</evaltype>
                        <formula/>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>Real Memory</value>
                                <operator>8</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>1d</lifetime>
                    <description/>
                    <item_prototypes>
                        <item_prototype>
                            <name>Used Memory %</name>
                            <type>15</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>hrMemoryFreePerc[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>0</value_type>
                            <allowed_hosts/>
                            <units>%</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params>last(&quot;hrMemoryUsed[{#SNMPINDEX}]&quot;)/&#13;
last(&quot;hrMemoryTotal[{#SNMPINDEX}]&quot;)*100</params>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Free Memory</name>
                            <type>15</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>hrMemoryFree[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>Bytes</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params>last(&quot;hrMemoryTotal[{#SNMPINDEX}]&quot;)-last(&quot;hrMemoryUsed[{#SNMPINDEX}]&quot;)</params>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Total Memory</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.25.2.2.0</snmp_oid>
                            <key>hrMemoryTotal[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>Bytes</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>1</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Memory Used</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>hrMemoryUsed[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>Bytes</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>Memory</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>1</type>
                                    <params>1024</params>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>({Template SNMP OS ESXi:hrMemoryUsed[{#SNMPINDEX}].last(0)} / {Template SNMP OS ESXi:hrMemoryTotal[{#SNMPINDEX}].last(0)} &gt; 0.9) and ({Template SNMP OS ESXi:hrMemoryFree[{#SNMPINDEX}].last(0)} &lt; 512M)</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>Available Memory is less than 10%, {ITEM.LASTVALUE3} remaining</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>0</status>
                            <priority>2</priority>
                            <description/>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags/>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes/>
                    <host_prototypes/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                </discovery_rule>
                <discovery_rule>
                    <name>Virtual Machines</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.6876.2.1.1.2]</snmp_oid>
                    <key>vmwVmDisplayName</key>
                    <delay>1d</delay>
                    <status>0</status>
                    <allowed_hosts/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port>161</port>
                    <filter>
                        <evaltype>0</evaltype>
                        <formula/>
                        <conditions/>
                    </filter>
                    <lifetime>1d</lifetime>
                    <description/>
                    <item_prototypes>
                        <item_prototype>
                            <name>VM Guest OS {#SNMPVALUE}</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.4.1.6876.2.1.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>vmwVMGuestOS.[{#SNMPINDEX}]</key>
                            <delay>1h</delay>
                            <history>90d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port>161</port>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>RAID</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>VM Guest State {#SNMPVALUE}</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.4.1.6876.2.1.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>vmwVMGuestState.[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port>161</port>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>RAID</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>VM Power State {#SNMPVALUE}</name>
                            <type>4</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.4.1.6876.2.1.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>vmwVMState.[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>90d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port>161</port>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>RAID</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>1</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes/>
                            <master_item/>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>({Template SNMP OS ESXi:vmwVMGuestState.[{#SNMPINDEX}].regexp(&quot;not running&quot;)}=1) and ({Template SNMP OS ESXi:vmwVMState.[{#SNMPINDEX}].regexp(&quot;powered on&quot;)}=1)</expression>
                            <recovery_mode>0</recovery_mode>
                            <recovery_expression/>
                            <name>Guest Tools not running or out of date on {#SNMPVALUE}</name>
                            <correlation_mode>0</correlation_mode>
                            <correlation_tag/>
                            <url/>
                            <status>1</status>
                            <priority>1</priority>
                            <description>Checks if Guest Tools are running on a powered on VM</description>
                            <type>0</type>
                            <manual_close>0</manual_close>
                            <dependencies/>
                            <tags/>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes/>
                    <host_prototypes/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                </discovery_rule>
            </discovery_rules>
            <httptests/>
            <macros/>
            <templates/>
            <screens/>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;4600944) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;4179633)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>ESXi critically outdated on {HOST.NAME} (running: {ITEM.LASTVALUE1} build {ITEM.LASTVALUE2})</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>2</priority>
            <description>Enter the last critical bugfix version for each major ESXi product.&#13;
&#13;
Logic works on Major build, e.g. 6.0 and build number which changes often. This then does an | (OR) to check if it's 5.5 or 6.0</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;4600944) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;4345813)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>ESXi outdated on {HOST.NAME} (running: {ITEM.LASTVALUE1} build {ITEM.LASTVALUE2})</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>1</priority>
            <description>Catch-all. Checks that the version of VMWare is the current version.&#13;
&#13;
Logic works on Major build, e.g. 6.0 and build number which changes often. This then does an | (OR) to check if it's 5.5 or 6.0</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies>
                <dependency>
                    <name>ESXi critically outdated on {HOST.NAME} (running: {ITEM.LASTVALUE1} build {ITEM.LASTVALUE2})</name>
                    <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;4600944) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;4179633)</expression>
                    <recovery_expression/>
                </dependency>
            </dependencies>
            <tags/>
        </trigger>
        <trigger>
            <expression>{RDP Users:vfs.file.exists[C:\Zabbix\RDPUsers.cmd].last(0)}=0</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>Hey! {HOST.NAME} has no C:\Zabbix\RDPUsers.cmd installed</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>1</priority>
            <description>If the C:\Zabbix\RDPUsers.cmd file does not exist, it is not possible to monitor logged in RDP users, so we will throw an alert</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template SNMP OS ESXi:sysUpTime.nodata(24h)}=1</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>Hey! {HOST.NAME} has not returned SNMP data for more than 24hrs!</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>1</priority>
            <description>If the uptime has not changed in 24hrs, it is safe to presume there has been no data returned.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{RDP Users:vfs.file.cksum[C:\Zabbix\RDPUsers.cmd].last(0)}&lt;&gt;334614066</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>Hey! {HOST.NAME} has the wrong RDPUsers.cmd version!</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>1</priority>
            <description>if the checksum does not match then you are not running hte correct version of the script. This may lead to false or non-existent alerts in zabbix.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{RDP Users:net.tcp.listen[7279].last(#1)}=0 and {RDP Users:net.tcp.listen[3389].last(#1)}=0</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>Hey! {HOST.NAME} is not listening on port 7279/TCP or 3389/TCP</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>1</priority>
            <description>If TCP/7279 or 3389/TCP is not open then raise an alert</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{RDP Users:service_state[TermService].last(0)}&lt;&gt;0</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>Remote Desktop Services Service Stopped</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>3</priority>
            <description>If TermService service is stoppped, users cannot RDP in.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is EOL on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (ESXi 5.5)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>1</status>
            <priority>4</priority>
            <description>Checks if the version of VMWare is EOL if running 5.5 per https://www.vmware.com/content/dam/digitalmarketing/vmware/en/pdf/support/product-lifecycle-matrix.pdf</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;15169789) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(6.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;15177306) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(6.7.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;15160138)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (CVE-2019-5544)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>4</priority>
            <description>https://www.vmware.com/security/advisories/VMSA-2019-0022.html affects port 423/TCP which one will want to limit down via firewall rule such as https://kb.vmware.com/s/article/76372&#13;
&#13;
NB: Also apply the patch. Though all ESXi ports ought ot be firewalled where possible.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3380124) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3343343)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (Jan 2016 CBT)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>4</priority>
            <description>Checks that the version of VMWare is the current version.&#13;
&#13;
Logic works on Major build, e.g. 6.0 and build number which changes often. This then does an | (OR) to check if it's 5.5 or 6.0&#13;
&#13;
This check is to let us know any which aren'tat latest build (non critical CBT is covered in another trigger.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;2715440) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;2718055)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (May 2015 CBT)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>4</priority>
            <description>ESX 5.5/6.0 CBT corruption fix build May 2015&#13;
&#13;
ESX 6.0: http://kb.vmware.com/kb/2116126&#13;
ESX 5.5: http://kb.vmware.com/kb/2090639&#13;
&#13;
c.f: http://www.virten.net/2015/05/esxi-6-0-may-2015-cbt-fix-patch-build-2715440/</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3073146</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (MIGRATION)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>1</priority>
            <description>This will alert that the possible migration bug from VMs which were migrated from ESX 5.5 to ESX 6.0&#13;
&#13;
c.f: http://kb.vmware.com/kb/2132153</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}=5969303) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(6.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}=5310538) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}=5224934)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (NIC Firmware)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>4</priority>
            <description>Checks that the version of VMWare is the current version.&#13;
&#13;
Logic works on Major build, e.g. 6.0 and build number which changes often. This then does an | (OR) to check if it's 5.5 or 6.0&#13;
&#13;
On following builds&#13;
6.5 U1 Jul 2017 vSphere 6.5 U1 Build 5969303 net-bnx2x - 2.713.30.v60.7&#13;
6.5 Jul 2017 vSphere 6.5 Build 5310538 net-bnx2x - 2.713.30.v60.7&#13;
6.0 U3 Jul 2017 vSphere 6.0 U3 Build 5224934 net-bnx2x -  2.713.30.v60.7&#13;
&#13;
The Broadcom cards will act in a manner which corrupts the firmware to the point the NIC needs replaced. Per https://h20566.www2.hpe.com/hpsc/doc/public/display?docId=a00027033en_us &#13;
&#13;
HPE hjave suggested an in place upgrade of the firmware or driver can solve this issue, but you MUST NOT reboot the host.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;1331820</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (NIC PSOD)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>4</priority>
            <description>Checks that the version of VMWare is not the version which PSODs on sending data.&#13;
&#13;
https://retrorabble.wordpress.com/2014/09/27/purple-esxi-rain/</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3247720) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3248547)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (Not Latest Build)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>1</status>
            <priority>1</priority>
            <description>Checks that the version of VMWare is the current version.&#13;
&#13;
Logic works on Major build, e.g. 6.0 and build number which changes often. This then does an | (OR) to check if it's 5.5 or 6.0&#13;
&#13;
This check is to let us know any which aren'tat latest build (non critical CBT is covered in another trigger.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3247720</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (Nov 2015 CBT)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>4</priority>
            <description>This will alert that the November 2015 CBT corruption bug is possible on ESX 6.0. This is *not* the same CBT corruption bug from May 2015, or even the other one from 2014 when ESX 6.0 went GA.&#13;
&#13;
c.f: http://kb.vmware.com/kb/2137546</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3116895</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (SNAPSHOT)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>2</priority>
            <description>Checks that the version of VMWare 5.5 is not the version which bombs out on Error 11 with snapshot consolidation&#13;
&#13;
http://kb.vmware.com/kb/2133825</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;7273056) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;6856897) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;6480267)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (SPECTRE &amp; MELTDOWN)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>2</priority>
            <description>Checks that the version of VMWare is the current version.&#13;
&#13;
Logic works on Major build, e.g. 6.0 and build number which changes often. This then does an | (OR) to check if it's 5.5 or 6.0&#13;
&#13;
Following Builds Fix the Issue:&#13;
6.5 ESXi650-201712101 build 7273056&#13;
6.0 ESXi600-201711101 build 6856897&#13;
5.5 ESXi550-201709101 build 6480267&#13;
&#13;
All builds below this are vulnerable. This is a disastrous outcome as it can allow memory compromise between guests.&#13;
&#13;
https://lists.vmware.com/pipermail/security-announce/2018/000397.html</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;7618464)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (SUBSEQUENT SPECTRE PATCH)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>2</priority>
            <description>Checks that the version of VMWare is the current version.&#13;
&#13;
Logic works on Major build, e.g. 6.0 and build number which changes often. This then does an | (OR) to check if it's 5.5 or 6.0&#13;
&#13;
Following Builds Fix the Issue:&#13;
6.5 ESXi650-201712101 build 7273056&#13;
6.0 ESXi600-201711101 build 6856897&#13;
5.5 ESXi550-201709101 build 6480267&#13;
&#13;
All builds below this are vulnerable. This is a disastrous outcome as it can allow memory compromise between guests.&#13;
&#13;
https://lists.vmware.com/pipermail/security-announce/2018/000397.html</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies>
                <dependency>
                    <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (SPECTRE &amp; MELTDOWN)</name>
                    <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;7273056) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;6856897) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;6480267)</expression>
                    <recovery_expression/>
                </dependency>
            </dependencies>
            <tags/>
        </trigger>
        <trigger>
            <expression>({Template SNMP OS ESXi:vmwProdVersion.0.str(6.0.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3247720) or ({Template SNMP OS ESXi:vmwProdVersion.0.str(5.5.0)}=1 and {Template SNMP OS ESXi:VMProdBuild.0.last()}&lt;3248547)</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>VMWare ESXi is outdated on {HOST.NAME} ({ITEM.LASTVALUE1} build {ITEM.LASTVALUE2}) (Unwanted Auto CBT switching)</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>2</priority>
            <description>Checks that the version of VMWare is the current version.&#13;
&#13;
Logic works on Major build, e.g. 6.0 and build number which changes often. This then does an | (OR) to check if it's 5.5 or 6.0&#13;
&#13;
This check is to let us know any which aren'tat latest build (non critical CBT is covered in another trigger.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Spamhaus Blacklisting:log[/var/log/syslog,&quot;Client host (\[.*\] blocked using \w+)&quot;,,,,\1,].nodata(1h)}&lt;1</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>{HOST.NAME} Outgoing emails blocked: {ITEM.LASTVALUME1}</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>4</priority>
            <description/>
            <type>0</type>
            <manual_close>1</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{RDP Users:RDPUsers.str(rdp-tcp)}&lt;&gt;0 and {RDP Users:RDPUsers.time(0)}&gt;170000</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>{HOST.NAME} RDP users:  {ITEM.LASTVALUE1}</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>0</priority>
            <description>Search for users connected via RDP to server and throw an alert if we find them, if the time is after 5pm (1700)</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
    </triggers>
</zabbix_export>
